<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Algorithms Â· Diagonalizations</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Diagonalizations logo"/></a><div class="docs-package-name"><span class="docs-autofit">Diagonalizations</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Documentation</a></li><li><a class="tocitem" href="../Diagonalizations/">Diagonalizations</a></li><li><span class="tocitem">Filters</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">One dataset (m=1)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../pca/">PCA</a></li><li><a class="tocitem" href="../whitening/">Whitening</a></li><li><a class="tocitem" href="../csp/">CSP</a></li><li><a class="tocitem" href="../cstp/">CSTP</a></li><li><a class="tocitem" href="../ajd/">AJD</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Two datasets (m=2)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../mca/">MCA</a></li><li><a class="tocitem" href="../cca/">CCA</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Several datasets (m&gt;2)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../gmca/">gMCA</a></li><li><a class="tocitem" href="../gcca/">gCCA</a></li><li><a class="tocitem" href="../majd/">mAJD</a></li></ul></li></ul></li><li><a class="tocitem" href="../tools/">Tools</a></li><li class="is-active"><a class="tocitem" href>Algorithms</a><ul class="internal"><li><a class="tocitem" href="#using-solvers-1"><span>using solvers</span></a></li><li><a class="tocitem" href="#Multi-threading-1"><span>Multi-threading</span></a></li><li><a class="tocitem" href="#Speed-1"><span>Speed</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Algorithms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Algorithms</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Marco-Congedo/Diagonalizations.jl/blob/master/docs/src/algorithms.md" title="Edit on GitHub"><span class="docs-icon fab">ï‚›</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Algorithms-1"><a class="docs-heading-anchor" href="#Algorithms-1">Algorithms</a><a class="docs-heading-anchor-permalink" href="#Algorithms-1" title="Permalink"></a></h1><p>The advanced diagonalization methods implemented in <em>Diagonalizations.jl</em>, namely, <a href="../gmca/#gMCA-1">gMCA</a>, <a href="../gcca/#gCCA-1">gCCA</a>, <a href="../ajd/#AJD-1">AJD</a> and <a href="../majd/#mAJD-1">mAJD</a> are solved by iterative algorithms, here also called <em>solvers</em>.</p><p>Solvers differ from one another in several fashions:</p><ul><li>the restriction they impose on the solution(s) (orthogonal/unitary or non-singular)</li><li>whether they support complex data or only real data</li><li>whether they take as input only positive-definite (PD) matrices or all symmetric/Hermitian matrices</li><li>the diagonalization criterion they minimize</li><li>the optimization method they employ</li><li>the diagonalization methods they support</li><li>their initialization</li><li>whether they support multi-threading or not</li></ul><p>To date six solvers are implemented:</p><ul><li><strong>Orthogonal joint blind source separation</strong> (OJOB: Congedo et al., 2012<a href="../#-1">ðŸŽ“</a>)</li><li><strong>Non-orthogonal joint blind source separation</strong> (NoJOB: Congedo et al., 2012<a href="../#-1">ðŸŽ“</a>)</li><li><strong>Log-likelyhood</strong> (LogLike: Pham, 2001<a href="../#-1">ðŸŽ“</a>)</li><li><strong>Log-likelyhood Real</strong> (LogLikeR: Pham, 2001<a href="../#-1">ðŸŽ“</a>)</li><li><strong>Joint Approximate Diagonalization of Eigenmatrices</strong> (JADE: Cardoso and Souloumiac, 1996<a href="../#-1">ðŸŽ“</a>)</li><li><strong>Gauss Approximate Joint Diagonalization</strong> (GAJD, unpublished, from the author)</li></ul><p>Their main characteristics and domain of application are summarized in the following table:</p><table><tr><th style="text-align: left">Algorithm</th><th style="text-align: left">Solution</th><th style="text-align: left">Complex data</th><th style="text-align: left">Only PD</th><th style="text-align: left">Criterion</th><th style="text-align: left">Multi-threaded</th><th style="text-align: left">Supported Methods</th></tr><tr><td style="text-align: left">OJoB</td><td style="text-align: left">Orthogonal/Unitary</td><td style="text-align: left">yes</td><td style="text-align: left">no</td><td style="text-align: left">least-squares</td><td style="text-align: left">yes</td><td style="text-align: left">gMCA, gCCA, AJD, mAJD</td></tr><tr><td style="text-align: left">NoJoB</td><td style="text-align: left">non-singular</td><td style="text-align: left">yes</td><td style="text-align: left">no</td><td style="text-align: left">least-squares</td><td style="text-align: left">yes</td><td style="text-align: left">gMCA, AJD, mAJD</td></tr><tr><td style="text-align: left">LogLike</td><td style="text-align: left">non-singular</td><td style="text-align: left">yes</td><td style="text-align: left">yes</td><td style="text-align: left">log-likelihood</td><td style="text-align: left">no</td><td style="text-align: left">AJD</td></tr><tr><td style="text-align: left">LogLikeR</td><td style="text-align: left">non-singular</td><td style="text-align: left">no</td><td style="text-align: left">yes</td><td style="text-align: left">log-likelihood</td><td style="text-align: left">no</td><td style="text-align: left">AJD</td></tr><tr><td style="text-align: left">JADE</td><td style="text-align: left">Orthogonal/Unitary</td><td style="text-align: left">yes</td><td style="text-align: left">no</td><td style="text-align: left">least-squares</td><td style="text-align: left">no</td><td style="text-align: left">AJD</td></tr><tr><td style="text-align: left">GAJD</td><td style="text-align: left">non-singular</td><td style="text-align: left">no</td><td style="text-align: left">no</td><td style="text-align: left">least-squares</td><td style="text-align: left">no</td><td style="text-align: left">AJD</td></tr></table><h2 id="using-solvers-1"><a class="docs-heading-anchor" href="#using-solvers-1">using solvers</a><a class="docs-heading-anchor-permalink" href="#using-solvers-1" title="Permalink"></a></h2><p>A solver is to find <span>$m$</span> matrices, where <span>$m$</span> depends on the sought diagonalization method (see <a href="../#Overview-1">Overview</a>). All algorithms by default are initialized by <span>$m$</span> identity matrices, with the exception of <em>NoJoB</em>, for which, following Congedo et al. (2011)<a href="../#-1">ðŸŽ“</a>, the <span>$m^{th}$</span> solution matrix is initalized by the eigenvectors of</p><p><span>$\frac{1}{mk}\sum_{j=1}^m\sum_{l=1}^k C_{mjk}C_{mjk}^H$</span>,</p><p>where <span>$C_{mjk}$</span> is the cross-covariance matrix between dataset <span>$m$</span> and dataset <span>$j$</span> for observation <span>$k$</span>. When <span>$m=1$</span>, for instance in the case of <em>AJD</em>, those are just the <span>$k$</span> covariance matrices to be jointly diagonalized.</p><p>A matrix (if <span>$m=1$</span>) or a vector of matrices (if <span>$m&gt;1$</span>) can be passed with the <code>init</code> argument in order to initialize the solver differently. Note that for <em>LogLike</em> and <em>LogLikeR</em> algorithms the actual approximate joint diagonalizer will be given by <code>init*B</code>, where <code>B</code> is the output of the algorithms.</p><p><code>tol</code> is the tolerance for convergence of the solver. By default it is set to the square root of <code>Base.eps</code> of the nearest real type of the data input. If the solver encounters difficulties in converging, try setting <code>tol</code> in between 1e-6 and 1e-3.</p><p>Argument <code>maxiter</code> is the maximum number of iterations allowed to the solver. The default values are given in the following table:</p><table><tr><th style="text-align: left">Algorithm</th><th style="text-align: left">max iterations</th></tr><tr><td style="text-align: left">OJoB</td><td style="text-align: left">1000 for real data, 3000 for complex data</td></tr><tr><td style="text-align: left">NoJoB</td><td style="text-align: left">1000 for real data, 3000 for complex data</td></tr><tr><td style="text-align: left">Log-Like</td><td style="text-align: left">60 for real data, 180 for complex data</td></tr><tr><td style="text-align: left">Log-LikeR</td><td style="text-align: left">40 (real data only)</td></tr><tr><td style="text-align: left">JADE</td><td style="text-align: left">60 for real data, 180 for complex data</td></tr><tr><td style="text-align: left">GAJD</td><td style="text-align: left">120 (real data only)</td></tr></table><p>If the maximum number of iteration is attained, a warning will be printed in the REPL. In this case, try increasing <code>maxiter</code> and/or <code>tol</code>.</p><h2 id="Multi-threading-1"><a class="docs-heading-anchor" href="#Multi-threading-1">Multi-threading</a><a class="docs-heading-anchor-permalink" href="#Multi-threading-1" title="Permalink"></a></h2><p>Besides being the most versitile (they support all methods), the OJoB and NoJOB algorithms also supports multi-threading. The methods&#39; constructors feature the <code>threaded</code> optional keyword argument, which is true by default. If <code>threaded</code> is true and <span>$n&gt;x$</span> and <span>$x&gt;1$</span>, where <span>$x$</span> is the number of threads Julia is instructed to use and <span>$n$</span> is the dimension of the input matrices, the algorithms run in multi-threaded mode paralellising several comptations over <span>$n$</span>.</p><p>Besides being optionally multi-threaded, these algorithms heavely use BLAS. Before running these methods you may want to set the number of threades Julia is instructed to use to the number of logical CPUs of your machine and set <code>BLAS.set_num_threads(Sys.CPU_THREADS)</code>. If you are <code>using</code> any of the package written by the author, this is done automatically. See <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Threads-1">these notes</a>.</p><h2 id="Speed-1"><a class="docs-heading-anchor" href="#Speed-1">Speed</a><a class="docs-heading-anchor-permalink" href="#Speed-1" title="Permalink"></a></h2><p>Indicatively, the tables here below reports the median execution time in ms required to converge on a regular laptop computer with a tolerence set to 1e-6 in the case of a set of <span>$k$</span> exactly diagonalizable real matrices of dimension <span>$nÂ·n$</span>:</p><table><tr><th style="text-align: left">n, k</th><th style="text-align: left">GAJD</th><th style="text-align: left">NoJoB</th><th style="text-align: left">NoJoB single-thread</th><th style="text-align: left">LogLike</th></tr><tr><td style="text-align: left">5, 5</td><td style="text-align: left">3</td><td style="text-align: left">N.A.</td><td style="text-align: left">6</td><td style="text-align: left">0.5</td></tr><tr><td style="text-align: left">5, 50</td><td style="text-align: left">0.73</td><td style="text-align: left">N.A.</td><td style="text-align: left">8.7</td><td style="text-align: left">1.2</td></tr><tr><td style="text-align: left">5, 500</td><td style="text-align: left">1.85</td><td style="text-align: left">N.A.</td><td style="text-align: left">49</td><td style="text-align: left">8.2</td></tr><tr><td style="text-align: left">5, 5000</td><td style="text-align: left">21</td><td style="text-align: left">N.A.</td><td style="text-align: left">524</td><td style="text-align: left">80</td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">25, 5</td><td style="text-align: left">256</td><td style="text-align: left">606</td><td style="text-align: left">1080</td><td style="text-align: left">47</td></tr><tr><td style="text-align: left">25, 50</td><td style="text-align: left">147</td><td style="text-align: left">63</td><td style="text-align: left">112</td><td style="text-align: left">227</td></tr><tr><td style="text-align: left">25, 500</td><td style="text-align: left">356</td><td style="text-align: left">355</td><td style="text-align: left">602</td><td style="text-align: left">1917</td></tr><tr><td style="text-align: left">25, 5000</td><td style="text-align: left">4886</td><td style="text-align: left">3955</td><td style="text-align: left">5306</td><td style="text-align: left">36963</td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">50, 5</td><td style="text-align: left">1584</td><td style="text-align: left">8576</td><td style="text-align: left">4095</td><td style="text-align: left">310</td></tr><tr><td style="text-align: left">50, 50</td><td style="text-align: left">1056</td><td style="text-align: left">575</td><td style="text-align: left">455</td><td style="text-align: left">2180</td></tr><tr><td style="text-align: left">50, 500</td><td style="text-align: left">4337</td><td style="text-align: left">1109</td><td style="text-align: left">2286</td><td style="text-align: left">21100</td></tr></table><table><tr><th style="text-align: left">n, k</th><th style="text-align: left">OJoB</th><th style="text-align: left">OJoB single-thread</th><th style="text-align: left">JADE</th></tr><tr><td style="text-align: left">5, 5</td><td style="text-align: left">N.A</td><td style="text-align: left">0.3</td><td style="text-align: left">0.34</td></tr><tr><td style="text-align: left">5, 50</td><td style="text-align: left">N.A</td><td style="text-align: left">0.91</td><td style="text-align: left">0.4</td></tr><tr><td style="text-align: left">5, 500</td><td style="text-align: left">N.A</td><td style="text-align: left">6.3</td><td style="text-align: left">2.3</td></tr><tr><td style="text-align: left">5, 5000</td><td style="text-align: left">N.A</td><td style="text-align: left">58</td><td style="text-align: left">24</td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">25, 5</td><td style="text-align: left">2</td><td style="text-align: left">3</td><td style="text-align: left">17.1</td></tr><tr><td style="text-align: left">25, 50</td><td style="text-align: left">5.4</td><td style="text-align: left">7.3</td><td style="text-align: left">50.2</td></tr><tr><td style="text-align: left">25, 500</td><td style="text-align: left">36.5</td><td style="text-align: left">46.1</td><td style="text-align: left">452</td></tr><tr><td style="text-align: left">25, 5000</td><td style="text-align: left">349</td><td style="text-align: left">464</td><td style="text-align: left">9937</td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">50, 5</td><td style="text-align: left">9.6</td><td style="text-align: left">11.2</td><td style="text-align: left">106</td></tr><tr><td style="text-align: left">50, 50</td><td style="text-align: left">17.6</td><td style="text-align: left">26.39</td><td style="text-align: left">683</td></tr><tr><td style="text-align: left">50, 500</td><td style="text-align: left">102</td><td style="text-align: left">192</td><td style="text-align: left">7315</td></tr><tr><td style="text-align: left">50, 5000</td><td style="text-align: left">1214</td><td style="text-align: left">2045</td><td style="text-align: left">136469</td></tr></table><p>Among the non-singular AJD algorithms the fastest algorithm per iteration is by far GAJD. The fastest convergence is achieved by LogLike. The GAJD algorithm scales well over the number of input matrices (<span>$k$</span>). NoJoB scales very well over the dimension of the input matrices (<span>$n$</span>). For small <span>$n$</span> and small <span>$k$</span>, logLike performs better. For small <span>$n$</span> and <span>$k$</span> large, GAJD performs better.</p><p>Among the orthogonal/unitary AJD algorithms, OJoB outperforms JADE in all situations, but for <span>$n$</span> small.</p><p>In a summary, OJoB and NoJoB offers excellent speed in the most common situations. The only cases where they do not perform best is when <span>$k&lt;n$</span> (because of their slow convergence with such settings) or when either <span>$k$</span>  or <span>$n$</span> are small. The following table reports suggestions on how to choose an algorithm depending on <span>$n$</span> and <span>$k$</span>:</p><table><tr><th style="text-align: left">n</th><th style="text-align: left">k</th><th style="text-align: left">Orhogonal/unitary</th><th style="text-align: left">non-singular</th></tr><tr><td style="text-align: left">small</td><td style="text-align: left">small</td><td style="text-align: left">LogLike</td><td style="text-align: left">JADE</td></tr><tr><td style="text-align: left">small</td><td style="text-align: left">large</td><td style="text-align: left">GAJD</td><td style="text-align: left">JADE</td></tr><tr><td style="text-align: left">large</td><td style="text-align: left">small</td><td style="text-align: left">LogLike</td><td style="text-align: left">OJoB</td></tr><tr><td style="text-align: left">large</td><td style="text-align: left">large</td><td style="text-align: left">NoJOB</td><td style="text-align: left">OJoB</td></tr></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tools/">Â« Tools</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 19 January 2020 23:31">Sunday 19 January 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
